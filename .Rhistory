ggplot(subset(All_data,DW=="white" & IT=="200" & mean!=0),aes(wavelength,((counts-mean)/mean)*100))+geom_point(colour="blue",size=0.5,alpha=0.05)+ylab("Deviation (%)")+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_smooth(data=quant25p,aes(wavelength,quant025),color="yellow",size=1)+geom_smooth(data=quant25p,aes(wavelength,-quant025),color="yellow",size=1)+geom_smooth(data=quant95p,aes(wavelength,quant095),color="green",size=1)+geom_smooth(data=quant95p,aes(wavelength,-quant095),color="green",size=1)+geom_hline(yintercept=0,color="black")
a<-subset(All_data,IT=="200" & DW=="white" & mean!=0)
b<-subset(All_data,IT=="200" & DW=="dark" & mean!=0)
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,(sd/mean_diff)*100))+geom_point(colour="blue")+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+ylab("RSD (%)")+theme_classic()+xlab("Wavelength (nm)")
a<-subset(All_data,IT=="200" & DW=="white" & mean!=0)
b<-subset(All_data,IT=="200" & DW=="dark" & mean!=0)
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,(sd/mean_diff)*100))+geom_point(colour="blue",size=0.5)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
View(abc)
a<-subset(All_data,IT==200 & DW=="white" & mean!=0)
b<-subset(All_data,IT==200 & DW=="dark" & mean!=0)
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,(sd/mean_diff)*100))+geom_point(colour="blue",size=0.5)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
class(All_data$IT)
View(quant25)
quant25<-ddply(subset(All_data, IT==200 & DW=="white"), .(wavelength), summarize, quant025=quantile(counts-mean, probs = c(0.25)))
quant95<-ddply(subset(All_data, IT==200 & DW=="white"), .(wavelength), summarize,quant095=quantile(counts-mean, probs = c(0.025)))
ggplot(subset(All_data,DW=="white" & IT=="200"),aes(wavelength,counts-mean))+geom_point(colour="blue",size=0.5,alpha=0.05)+ylab("Deviation (counts)")+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_smooth(data=quant25,aes(wavelength,quant025),color="yellow",size=1)+geom_smooth(data=quant25,aes(wavelength,-quant025),color="yellow",size=1)+geom_smooth(data=quant95,aes(wavelength,quant095),color="green",size=1)+geom_smooth(data=quant95,aes(wavelength,-quant095),color="green",size=1)+geom_hline(yintercept=0,color="black")
View(a)
View(ab)
View(abc)
a<-subset(All_data,IT==200 & DW=="white" & mean!=0)
b<-subset(All_data,IT==200 & DW=="dark" & mean!=0)
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,(sd/abs(mean_diff)*100))+geom_point(colour="blue",size=0.5)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
a<-subset(All_data,IT==200 & DW=="white" & mean!=0)
b<-subset(All_data,IT==200 & DW=="dark" & mean!=0)
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,((sd/abs(mean_diff))*100))+geom_point(colour="blue",size=0.5)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
ggplot(abc,aes(wavelength,(abs(sd/mean_diff)*100)))+geom_point(colour="blue",size=0.5)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
ggplot(abc,aes(wavelength,(abs(sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
View(ab)
View(a)
View(abc)
View(a)
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+xlim(250,1100)+ylab("RSD (%)")+ylim(0,0.75)+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+ylab("RSD (%)")+theme_classic()+theme_classic()+xlab("Wavelength (nm)")
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=mean(white-dark),sd=sd(white-dark))
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+ylab("RSD (%)")+theme_classic()+xlim(250,1100)+xlab("Wavelength (nm)")
```
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+ylab("RSD (%)")+theme_classic()+xlim(250,1100)+ylim(0,2)+xlab("Wavelength (nm)")
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(xlim=c(250,1100),ylim=c(0,3))+xlab("Wavelength (nm)")+ylab("RSD (%)")
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(xlim=c(250,1100),ylim=c(0,5))+xlab("Wavelength (nm)")+ylab("RSD (%)")
ggplot(abc,aes(wavelength,((sd/mean_diff)*100)))+geom_point(colour="blue",size=1)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(xlim=c(250,1100),ylim=c(0,6))+xlab("Wavelength (nm)")+ylab("RSD (%)")
ref200<-ddply(ab,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ggplot(ref200,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.05)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")
ggplot(ref200,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.25)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")
ggplot(ref200,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.10)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")
ggplot(ref200,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.15)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")
ggplot(ref200,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.15)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")
ab1<-data.frame(wavelength=a1$wavelength,mwhite=a1$mean,mdark=b1$mean,whitesd=a1$sd)
View(ab)
View(abc)
View(ab)
View(ab)
psed1<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
View(psed1)
View(a)
View(a)
View(ab)
View(abc)
View(psed1)
sed2<-ddply(psed1,.(wavelength), summarize,mean_diff=mean(a$counts-b$counts),sd3=sd(a$counts-b$counts))
library(dply)
library(dplyr)
library(plyr)
psed2<-ddply(psed1,.(wavelength), summarize,mean_diff=mean(a$counts-b$counts),sd3=sd(a$counts-b$counts))
View(psed2)
<-read.csv("/Users/ehson/Documents/r/Stellarnet3/processed/Stellarnet_data.csv")
p$X<-NULL
All_data<-p
check<-ddply(All_data,.(IT,DW,wavelength),summarize,mean=mean(counts),sd=sd(counts))
m<-merge(p,check)
All_data<-subset(m, wavelength<=1100 & wavelength>=200)
p<-read.csv("/Users/ehson/Documents/r/Stellarnet3/processed/Stellarnet_data.csv")
p$X<-NULL
All_data<-p
check<-ddply(All_data,.(IT,DW,wavelength),summarize,mean=mean(counts),sd=sd(counts))
m<-merge(p,check)
All_data<-subset(m, wavelength<=1100 & wavelength>=200)
x2<-subset(All_data,DW=="dark" & IT==2)
x20<-subset(All_data,DW=="dark" & IT==20)
x200<-subset(All_data,DW=="dark" & IT==200)
x1000<-subset(All_data,DW=="dark" & IT==1000)
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
darkr<-ddply(b,.(wavelength),summarize,range=(max(counts)-min(counts)))
darkr2<-merge(ab,darkr)
whiter<-ddply(a,.(wavelength),summarize,range=(max(counts)-min(counts)))
whiter2<-merge(ab,whiter)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
a1<-subset(All_data,IT==1000 & DW=="white" & wavelength<=450)
b1<-subset(All_data,IT==1000 & DW=="dark" & wavelength<=450 )
ab1<-data.frame(wavelength=a1$wavelength,mwhite=a1$mean,mdark=b1$mean,whitesd=a1$sd)
abc1<-ddply(ab1,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
a2<-subset(All_data,IT==1000 & DW=="white" & wavelength>=950)
b2<-subset(All_data,IT==1000 & DW=="dark" & wavelength>=950 )
ab2<-data.frame(wavelength=a2$wavelength,mwhite=a2$mean,mdark=b2$mean,whitesd=a2$sd)
abc2<-ddply(ab2,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
a3<-subset(All_data,IT==200 & DW=="white" & wavelength>450 & wavelength<950)
b3<-subset(All_data,IT==200 & DW=="dark" & wavelength>450 & wavelength<950 )
ab3<-data.frame(wavelength=a3$wavelength,mwhite=a3$mean,mdark=b3$mean,whitesd=a3$sd)
abc3<-ddply(ab3,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
z<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
ref<-ddply(z,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
z1<-data.frame(wavelength=a1$wavelength,white=a1$counts,dark=b1$counts)
z2<-data.frame(wavelength=a2$wavelength,white=a2$counts,dark=b2$counts)
z3<-data.frame(wavelength=a3$wavelength,white=a3$counts,dark=b3$counts)
ref1<-ddply(z1,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ref2<-ddply(z2,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ref3<-ddply(z3,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
a1<-subset(All_data,IT==1000 & DW=="white" & wavelength<=450)
b1<-subset(All_data,IT==1000 & DW=="dark" & wavelength<=450 )
ab1<-data.frame(wavelength=a1$wavelength,mwhite=a1$mean,mdark=b1$mean,whitesd=a1$sd)
abc1<-ddply(ab1,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
uvdarkr<-ddply(b1,.(wavelength),summarize,range=(max(counts)-min(counts)))
uvdarkr2<-merge(ab1,uvdarkr)
uvwhiter<-ddply(a1,.(wavelength),summarize,range=(max(counts)-min(counts)))
uvwhiter2<-merge(ab1,uvwhiter)
a2<-subset(All_data,IT==1000 & DW=="white" & wavelength>=950)
b2<-subset(All_data,IT==1000 & DW=="dark" & wavelength>=950 )
ab2<-data.frame(wavelength=a2$wavelength,mwhite=a2$mean,mdark=b2$mean,whitesd=a2$sd)
abc2<-ddply(ab2,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
nirdarkr<-ddply(b2,.(wavelength),summarize,range=(max(counts)-min(counts)))
nirdarkr2<-merge(ab2,nirdarkr)
nirwhiter<-ddply(a2,.(wavelength),summarize,range=(max(counts)-min(counts)))
nirwhiter2<-merge(ab2,nirwhiter)
a3<-subset(All_data,IT==200 & DW=="white" & wavelength>450 & wavelength<950)
b3<-subset(All_data,IT==200 & DW=="dark" & wavelength>450 & wavelength<950 )
ab3<-data.frame(wavelength=a3$wavelength,mwhite=a3$mean,mdark=b3$mean,whitesd=a3$sd)
abc3<-ddply(ab3,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
visdarkr<-ddply(b3,.(wavelength),summarize,range=(max(counts)-min(counts)))
visdarkr2<-merge(ab3,visdarkr)
viswhiter<-ddply(a3,.(wavelength),summarize,range=(max(counts)-min(counts)))
viswhiter2<-merge(ab3,viswhiter)
View(a)
psed1<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts,count_diff=a$counts-b$counts)
View(psed1)
psed2<-ddply(psed1,.(wavelength), summarize,mean_diff=mean(a$counts-b$counts),sd3=sd(count_diff)*3)
View(psed2)
psed2<-ddply(psed1,.(wavelength), summarize,mean_diff=mean(count_diff),sd3=sd(count_diff)*3)
View(psed2)
npsed1<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts,count_diff=a$counts-b$counts)
nppsed2<-ddply(psed1,.(wavelength), summarize,mean_diff=mean(count_diff),sd3=sd(count_diff)*3)
npsed2<-ddply(psed1,.(wavelength), summarize,mean_diff=mean(count_diff),sd3=sd(count_diff)*3)
ggplot(npsed2,aed(wavelength,sd3/mean_diff))+geom_line()
library(ggplot2)
ggplot(npsed2,aed(wavelength,sd3/mean_diff))+geom_line()
ggplot(npsed2,aes(wavelength,sd3/mean_diff))+geom_line()
View(psed2)
View(abc1)
View(abc)
View(abc1)
ggplot(abc,aes(wavelength,3*sd/mean_diff))+grom_line()
ggplot(abc,aes(wavelength,3*sd/mean_diff))+geom_line()
View(abc1)
View(abc1)
View(abc2)
View(abc3)
View(ab1)
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
View(a)
View(a)
View(ab)
View(ab)
View(ab)
View(darkr)
View(uvwhiter2)
View(uvwhiter2)
View(m)
remove(x1000)
remove(x2)
remove(x20)
remove(x200)
View(b)
View(darkr)
ab<-data.frame(wavelength=unique(a$wavelength),mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
View(ab)
View(darkr2)
View(darkr)
a<-ddply(subset(All_data,IT==200 & DW=="white"),.(wavelength),summarize,mwhite=mean(counts))
View(a)
b<-ddply(subset(All_data,IT==200 & DW=="dark"),.(wavelength),summarize,mwhite=mean(counts))
a<-ddply(subset(All_data,IT==200 & DW=="white"),.(wavelength),summarize,mwhite=mean(counts),sdwhite=sd(counts))
b<-ddply(subset(All_data,IT==200 & DW=="dark"),.(wavelength),summarize,mwhite=mean(counts),sdwhite=sd(counts))
View(a)
View(b)
a<-ddply(subset(All_data,IT==200 & DW=="white"),.(wavelength),summarize,mean=mean(counts),sd=sd(counts))
b<-ddply(subset(All_data,IT==200 & DW=="dark"),.(wavelength),summarize,mean=mean(counts),sd=sd(counts))
ab<-data.frame(wavelength=a$wavelength,mwhite=a$mean,mdark=b$mean,whitesd=a$sd,darksd=b$sd)
View(abc1)
View(a)
View(b)
View(ab)
darkr<-ddply(subset(All_data,IT==200 & DW=="dark"),.(wavelength),summarize,range=(max(counts)-min(counts)))
View(darkr)
darkr2<-merge(ab,darkr)
View(darkr2)
whiter<-ddply(subset(All_data,IT==200 & DW=="white"),.(wavelength),summarize,range=(max(counts)-min(counts)))
whiter2<-merge(ab,whiter)
View(abc)
ggplot(ab,aes(wavelength,(mwhite-mdartk/whitesd)))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(ab,aes(wavelength,(mwhite-mdark/whitesd)))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(ab,aes(wavelength,(mwhite-mdark/whitesd)))+geom_point(colour="blue",size=1,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
View(ab)
p<-read.csv("/Users/ehson/Documents/r/Stellarnet3/processed/Stellarnet_data.csv")
p$X<-NULL
All_data<-p
check<-ddply(All_data,.(IT,DW,wavelength),summarize,mean=mean(counts),sd=sd(counts))
m<-merge(p,check)
All_data<-subset(m, wavelength<=1100 & wavelength>=200)
p<-read.csv("/Users/ehson/Documents/r/Stellarnet3/processed/Stellarnet_data.csv")
p$X<-NULL
All_data<-p
check<-ddply(All_data,.(IT,DW,wavelength),summarize,mean=mean(counts),sd=sd(counts))
m<-merge(p,check)
All_data<-subset(m, wavelength<=1100 & wavelength>=200)
b<-subset(All_data,IT==200 & DW=="dark" )
View(b)
darkr<-ddply(b,.(wavelength),summarize,range=(max(counts)-min(counts)),s3d=sd(counts)*3)
View(darkr)
View(check)
darkr<-ddply(b,.(wavelength),summarize,range=(max(counts)-min(counts)),darks3d=sd(counts)*3)
View(darkr)
darkr2<-merge(ab,darkr)
ab<-data.frame(wavelength=a$wavelength,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
a<-subset(All_data,IT==200 & DW=="white")
ab<-data.frame(wavelength=a$wavelength,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
darkr2<-merge(ab,darkr)
View(darkr2)
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(colour="blue", size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100)), colour="red", size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(colour="blue", size=0.15)
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(colour="blue", size=0.15)+geom_lines(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)),colour="red",size=0.16)
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(colour="blue", size=0.15)+geom_line(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)),colour="red",size=0.16)
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(colour="blue", size=0.15)+geom_line(data=darkr2,aes(wavelength,((range/(mwhite-mdark))*100)),colour="red",size=0.16)
b1<-subset(All_data,IT==1000 & DW=="dark" & wavelength<=450 )
uvdarkr<-ddply(b1,.(wavelength),summarize,range=(max(counts)-min(counts)),uvs3d=sd(counts)*3)
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(colour="blue", size=0.15)+geom_line(data=whiter2,aes(wavelength,((whites3d/(mwhite-mdark))*100)), colour="red", size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
p<-read.csv("/Users/ehson/Documents/r/Stellarnet3/processed/Stellarnet_data.csv")
p$X<-NULL
All_data<-p
check<-ddply(All_data,.(IT,DW,wavelength),summarize,mean=mean(counts),sd=sd(counts))
m<-merge(p,check)
All_data<-subset(m, wavelength<=1100 & wavelength>=200)
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT,size=1))+geom_point(aes(colour=factor(IT)),size=1)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=0.5)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.25)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=1.5,alpha=0.15)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=2,alpha=0.05)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=2,alpha=0.5)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=1.5,alpha=0.5)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="dark" & IT==c(2,20,100,200,500,1000)),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.5)+geom_hline(yintercept=0)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(-300,300))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(subset(All_data,DW=="white",colour=IT,fill='IT'),aes(x=wavelength,y=counts,colour=IT))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.5)+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")
ggplot(abc,aes(wavelength,(mean_diff/sd)),colour=IT,fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
darkr<-ddply(b,.(wavelength),summarize,range=(max(counts)-min(counts)),darks3d=sd(counts)*3)
darkr2<-merge(ab,darkr)
whiter<-ddply(a,.(wavelength),summarize,range=(max(counts)-min(counts)),whites3d=sd(counts)*3)
whiter2<-merge(ab,whiter)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
ggplot(abc,aes(wavelength,(mean_diff/sd)),colour=IT,fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd)),colour="blue",fill="IT 200")+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(subset(All_data,DW=="white" & IT==c(2,20,100,200,500,1000) & wavelength>=900 ,colour=IT,fill='IT'),aes(x=wavelength,y=counts,colour=IT))+geom_line(aes(colour=factor(IT)),size=1,alpha=0.5)+scale_x_continuous(breaks=seq(from=900, to=1100, by=50))+coord_cartesian(xlim=c(900,1100),ylim=c(0,60000))+theme_classic()+ylab("Intensity (counts)")+xlab("Wavelength (nm)")+geom_vline(xintercept=930,colour="black",linetype="longdash")
ab<-data.frame(wavelength=a$wavelength,IT=a$IT,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
View(ab)
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,IT=a$IT,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
darkr<-ddply(b,.(wavelength),summarize,range=(max(counts)-min(counts)),darks3d=sd(counts)*3)
darkr2<-merge(ab,darkr)
whiter<-ddply(a,.(wavelength),summarize,range=(max(counts)-min(counts)),whites3d=sd(counts)*3)
whiter2<-merge(ab,whiter)
abc<-ddply(ab,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
abc<-ddply(ab,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill=IT)+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
View(abc)
a<-subset(All_data,IT==200 & DW=="white")
b<-subset(All_data,IT==200 & DW=="dark" )
ab<-data.frame(wavelength=a$wavelength,IT=a$IT,mwhite=a$mean,mdark=b$mean,whitesd=a$sd)
darkr<-ddply(b,.(wavelength),summarize,range=(max(counts)-min(counts)),darks3d=sd(counts)*3)
darkr2<-merge(ab,darkr)
whiter<-ddply(a,.(wavelength),summarize,range=(max(counts)-min(counts)),whites3d=sd(counts)*3)
whiter2<-merge(ab,whiter)
abc<-ddply(ab,.(wavelength,IT),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill=IT)+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
View(abc)
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill=facor(IT))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill="IT 200 ms")+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd)),fill="IT 200 ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)
ggplot(abc,aes(wavelength,(mean_diff/sd),fill="IT 200 ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),fill="IT"))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),fill='IT'))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),fill='IT'))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),colour=IT)+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),colour=IT))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),colour=IT))+geom_point(colour="blue",size=0.5,alpha=0.5)
ggplot(abc,aes(wavelength,(mean_diff/sd),colour=IT))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))
ggplot(abc,aes(wavelength,(mean_diff/sd),fill="IT 200"))+geom_point(colour="blue",size=0.5,alpha=0.5)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),fill="IT:200 ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+guides(fill=FALSE)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),fill="IT:200 ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+labs(fill=FALSE)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),color="blue",fill="IT:200ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+labs(fill=Non-partitioned)+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),color="blue",fill="IT:200ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+labs(fill="Non-partitioned"")+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),color="blue",fill="IT:200ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+labs(fill="Non-partitioned")+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),color="blue",size=2, fill="IT:200ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+labs(fill="Non-partitioned")+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(abc,aes(wavelength,(mean_diff/sd),fill="IT:200ms"))+geom_point(colour="blue",size=0.5,alpha=0.5)+labs(fill="Non-partitioned")+theme_classic()+scale_x_continuous(breaks=seq(from=200, to=1100, by=100))+coord_cartesian(ylim=c(0,500))+xlab("Wavelength (nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
a1<-subset(All_data,IT==1000 & DW=="white" & wavelength<=450)
b1<-subset(All_data,IT==1000 & DW=="dark" & wavelength<=450 )
ab1<-data.frame(wavelength=a1$wavelength,IT=a1$IT,mwhite=a1$mean,mdark=b1$mean,whitesd=a1$sd)
abc1<-ddply(ab1,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
# NIR
a2<-subset(All_data,IT==1000 & DW=="white" & wavelength>=950)
b2<-subset(All_data,IT==1000 & DW=="dark" & wavelength>=950 )
ab2<-data.frame(wavelength=a2$wavelength,IT=a2$IT,mwhite=a2$mean,mdark=b2$mean,whitesd=a2$sd)
abc2<-ddply(ab2,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
# VIS
a3<-subset(All_data,IT==200 & DW=="white" & wavelength>450 & wavelength<950)
b3<-subset(All_data,IT==200 & DW=="dark" & wavelength>450 & wavelength<950 )
ab3<-data.frame(wavelength=a3$wavelength,IT=a3$IT, mwhite=a3$mean,mdark=b3$mean,whitesd=a3$sd)
abc3<-ddply(ab3,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),color=IT, fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),color=IT, fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
View(abc1)
a1<-subset(All_data,IT==1000 & DW=="white" & wavelength<=450)
b1<-subset(All_data,IT==1000 & DW=="dark" & wavelength<=450 )
ab1<-data.frame(wavelength=a1$wavelength,IT=a1$IT,mwhite=a1$mean,mdark=b1$mean,whitesd=a1$sd)
abc1<-ddply(ab1,.(wavelength,IT),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
# NIR
a2<-subset(All_data,IT==1000 & DW=="white" & wavelength>=950)
b2<-subset(All_data,IT==1000 & DW=="dark" & wavelength>=950 )
ab2<-data.frame(wavelength=a2$wavelength,IT=a2$IT,mwhite=a2$mean,mdark=b2$mean,whitesd=a2$sd)
abc2<-ddply(ab2,.(wavelength,IT),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
# VIS
a3<-subset(All_data,IT==200 & DW=="white" & wavelength>450 & wavelength<950)
b3<-subset(All_data,IT==200 & DW=="dark" & wavelength>450 & wavelength<950 )
ab3<-data.frame(wavelength=a3$wavelength,IT=a3$IT, mwhite=a3$mean,mdark=b3$mean,whitesd=a3$sd)
abc3<-ddply(ab3,.(wavelength,IT),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),color=IT, fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
View(abc3)
View(abc2)
View(abc1)
View(abc2)
View(abc3)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),color=IT, fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),color=IT, fill='IT')+geom_point(colour=factor(IT),size=0.5,alpha=0.5)
View(abc3)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)), fill='IT')+geom_point(colour=factor(IT),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
```
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5,color=IT)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(colour="blue",size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd)),colour="red",size=0.5,alpha=0.5)+geom_point(data=abc2,aes(wavelength,mean_diff/sd),colour="green",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(colour="1000 ms",size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour="1000 ms"),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour="1000 ms"),color="blue",size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour="blue",fill="1000 ms"),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill=IT)+geom_point(aes(colour="blue"),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour="1000 ms"),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(fill=IT),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(fill=IT),size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd),fill=IT),colour="red",size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(fill=color(IT)),size=0.5,alpha=0.5)+geom_point(data=abc1,aes(wavelength,(mean_diff/sd),fill=factor(IT)),colour="red",size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(fill=colour(IT)),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour=factor(IT)),colour="blue",size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)),fill='IT')+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=1,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=1,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=1,alpha=0.5)+geom_point(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=1,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=1,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(fill="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(fill=IT)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT),fill='IT'),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT),fill=IT),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(fill="Gooz")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(colour="blue",size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(colour="green",size=0.5,alpha=0.5,fill=partitioned)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd)),colour="green",size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,(mean_diff/sd)),colour="green",size=0.5,alpha=0.5)+geom_line(data=abc,aes(wavelength,mean_diff/sd),colour="blue",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(colour="green",size=0.5,alpha=0.5,fill="partitioned")+geom_line(data=abc1,aes(wavelength,(mean_diff/sd)),colour="green",size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,(mean_diff/sd)),colour="green",size=0.5,alpha=0.5)+geom_line(data=abc,aes(wavelength,mean_diff/sd),colour="blue",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(colour="green",size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd)),colour="green",size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,(mean_diff/sd)),colour="green",size=0.5,alpha=0.5)+geom_line(data=abc,aes(wavelength,mean_diff/sd),colour="blue",size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")
ggplot(data=abc3,aes(wavelength,(mean_diff/sd)))+geom_line(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc1,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc2,aes(wavelength,(mean_diff/sd),colour=factor(IT)),size=0.5,alpha=0.5)+geom_line(data=abc,aes(wavelength,mean_diff/sd,colour=factor(IT)),size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(0,500))+xlab("Wavelength(nm)")+ylab("SNR")+labs(colour="IT")
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc,aes(mean_diff,(mean_diff/sd),colour="Non-partitioned",size=0.5,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(0,60000),ylim=c(0,500))+xlab("Intensity (counts)")+ylab("SNR")
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc,aes(mean_diff,(mean_diff/sd),colour="Non-partitioned"),size=0.5,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(0,60000),ylim=c(0,500))+xlab("Intensity (counts)")+ylab("SNR")
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(0,60000),ylim=c(0,500))+xlab("Intensity (counts)")+ylab("SNR")
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc,aes(mmean_diff,(mean_diff/sd),colour="Nonpartitioned"),size=0.5,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(0,60000),ylim=c(0,500))+xlab("Intensity (counts)")+ylab("SNR")
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc,aes(mean_diff,(mean_diff/sd),colour="Nonpartitioned"),size=0.5,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(0,60000),ylim=c(0,500))+xlab("Intensity (counts)")+ylab("SNR")
ggplot(data=abc3,aes(mean_diff,(mean_diff/sd)))+geom_line(aes(colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc1,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc2,aes(mean_diff,(mean_diff/sd),colour="Partitioned"),size=0.5,alpha=0.25)+geom_line(data=abc,aes(mean_diff,(mean_diff/sd),colour="Nonpartitioned"),size=0.5,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(0,60000),ylim=c(0,500))+xlab("Intensity (counts)")+ylab("SNR")+labs(colour="Method")
z<-data.frame(wavelength=a$wavelength,white=a$counts,dark=b$counts)
ref<-ddply(z,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ggplot(ref,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.15, alpha=0.5)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")
ggplot(ref,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.15, alpha=0.5)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")+labs(fill="Method")
ggplot(ref,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.15, alpha=0.5)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")+guides(fill=guide_legend(title="IT 200 ms"))
z1<-data.frame(wavelength=a1$wavelength,white=a1$counts,dark=b1$counts)
z2<-data.frame(wavelength=a2$wavelength,white=a2$counts,dark=b2$counts)
z3<-data.frame(wavelength=a3$wavelength,white=a3$counts,dark=b3$counts)
ref1<-ddply(z1,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ref2<-ddply(z2,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ref3<-ddply(z3,.(wavelength),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
z1<-data.frame(wavelength=a1$wavelength,IT=a1$IT,white=a1$counts,dark=b1$counts)
z2<-data.frame(wavelength=a2$wavelength,IT=a2$IT,white=a2$counts,dark=b2$counts)
z3<-data.frame(wavelength=a3$wavelength,IT=a3$IT,white=a3$counts,dark=b3$counts)
ref1<-ddply(z1,.(wavelength,IT),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ref2<-ddply(z2,.(wavelength,IT),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ref3<-ddply(z3,.(wavelength,IT),summarize, reflectance=(((white-mean(dark))/(mean(white)-mean(dark)))*100))
ggplot(ref1,aes(wavelength,reflectance))+geom_point((aes(colour=factor(IT),size=0.15, alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point((aes(colour=factor(IT)),size=0.15, alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT),size=0.15, alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.15,alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT),size=0.15,alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)))
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)))
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.15,alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.5)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.5)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=0.1, alpha=0.5)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=0.15,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=0.5, alpha=0.5)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=0.5, alpha=0.5)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")+labs(colour="IT")
ggplot(ref,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.5, alpha=0.25)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")
ggplot(ref,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.5, alpha=0.55)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")
ggplot(ref,aes(wavelength,reflectance))+geom_point(colour="blue", size=0.15, alpha=0.5)+ylab("Reflectance (%)")+xlim(250,1100)+ylim(90,110)+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+theme_classic()+xlab("Wavelength (nm)")+geom_hline(yintercept=100,color="black")
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.5,alpha=0.5)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=0.5, alpha=0.5)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=0.5,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")+labs(colour="IT")
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=0.15,alpha=0.5)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=0.15, alpha=0.5)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=0.15,alpha=0.5)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")+labs(colour="IT")
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.25)
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.25)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=1, alpha=0.25)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=1,alpha=0.25)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")+labs(colour="IT")
ggplot(ref1,aes(wavelength,reflectance))+geom_point(aes(colour=factor(IT)),size=1,alpha=0.05)+geom_point(data=ref2,aes(wavelength,reflectance,colour=factor(IT)), size=1, alpha=0.05)+geom_point(data=ref3,aes(wavelength,reflectance,colour=factor(IT)), size=1,alpha=0.05)+theme_classic()+coord_cartesian(xlim=c(200,1100),ylim=c(90,110))+scale_x_continuous(breaks=seq(from=250,to=1100,by=100))+xlab("Wavelength (nm)")+ylab("Reflectance (%)")+geom_hline(yintercept=100,color="black")+labs(colour="IT")
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour=factor(IT)), size=0.15)
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour=factor(IT)), size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100), colour=factor(IT)), size=0.15)
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise", size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100), colour="White Noise", size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"), size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100), colour="White Noise", size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100), colour="White Noise"),size=0.15)
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+xlab("Wavelength (nm)")+ylab("Noise (%)")+labs(fill="Non-partitioned")
ggplot(darkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=whiter2,aes(wavelength,((range/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+xlab("Wavelength (nm)")+ylab("Noise (%)")+labs(colour="Non-partitioned")
ggplot(uvdarkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((range/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((range/(mwhite-mdark))*100),colour="Dark Noise"), size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
a1<-subset(All_data,IT==1000 & DW=="white" & wavelength<=450)
b1<-subset(All_data,IT==1000 & DW=="dark" & wavelength<=450 )
ab1<-data.frame(wavelength=a1$wavelength,mwhite=a1$mean,mdark=b1$mean,whitesd=a1$sd)
abc1<-ddply(ab1,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
uvdarkr<-ddply(b1,.(wavelength),summarize,range=(max(counts)-min(counts)),uvdarks3d=sd(counts)*3)
uvdarkr2<-merge(ab1,uvdarkr)
uvwhiter<-ddply(a1,.(wavelength),summarize,range=(max(counts)-min(counts)),uvwhites3d=sd(counts)*3)
uvwhiter2<-merge(ab1,uvwhiter)
# NIR
a2<-subset(All_data,IT==1000 & DW=="white" & wavelength>=950)
b2<-subset(All_data,IT==1000 & DW=="dark" & wavelength>=950 )
ab2<-data.frame(wavelength=a2$wavelength,mwhite=a2$mean,mdark=b2$mean,whitesd=a2$sd)
abc2<-ddply(ab2,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
nirdarkr<-ddply(b2,.(wavelength),summarize,range=(max(counts)-min(counts)),nirdarks3d=sd(counts)*3)
nirdarkr2<-merge(ab2,nirdarkr)
nirwhiter<-ddply(a2,.(wavelength),summarize,range=(max(counts)-min(counts)),nirwhites3d=sd(counts)*3)
nirwhiter2<-merge(ab2,nirwhiter)
# VIS
a3<-subset(All_data,IT==200 & DW=="white" & wavelength>450 & wavelength<950)
b3<-subset(All_data,IT==200 & DW=="dark" & wavelength>450 & wavelength<950 )
ab3<-data.frame(wavelength=a3$wavelength,mwhite=a3$mean,mdark=b3$mean,whitesd=a3$sd)
abc3<-ddply(ab3,.(wavelength),summarize, mean_diff=(mwhite-mdark),sd=whitesd)
visdarkr<-ddply(b3,.(wavelength),summarize,range=(max(counts)-min(counts)),visdarks3d=sd(counts)*3)
visdarkr2<-merge(ab3,visdarkr)
viswhiter<-ddply(a3,.(wavelength),summarize,range=(max(counts)-min(counts)),viswhites3d=sd(counts)*3)
viswhiter2<-merge(ab3,viswhiter)
ggplot(uvdarkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((range/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((range/(mwhite-mdark))*100),colour="Dark Noise"), size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
```
ggplot(uvdarkr2,aes(wavelength,((range/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((range/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((range/(mwhite-mdark))*100),colour="Dark Noise"), size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((range/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")+labs(colour="Partitioned")
ggplot(darkr2,aes(wavelength,((darks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=whiter2,aes(wavelength,((whites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("(range/mwhite-mdark)*100")
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise",size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("Noise (%)")
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise",size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("Noise (%)")
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,10))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("Noise (%)")
ggplot(uvdarkr2,aes(wavelength,((uvdarks3d/(mwhite-mdark))*100)))+geom_line(aes(colour="Dark Noise"),size=0.15)+geom_line(data=visdarkr2,aes(wavelength,((visdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=nirdarkr2,aes(wavelength,((nirdarks3d/(mwhite-mdark))*100),colour="Dark Noise"),size=0.15)+geom_line(data=uvwhiter2,aes(wavelength,((uvwhites3d/(mwhite-mdark))*100), colour="White Noise"),size=0.15)+geom_line(data=viswhiter2,aes(wavelength,((viswhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+geom_line(data=nirwhiter2,aes(wavelength,((nirwhites3d/(mwhite-mdark))*100),colour="White Noise"),size=0.15)+theme_classic()+coord_cartesian(xlim=c(250,1100),ylim=c(0,5))+scale_x_continuous(breaks=seq(from=250,to=1100,by=50))+scale_y_continuous(breaks=seq(from=0,to=10,by=0.5))+xlab("Wavelength (nm)")+ylab("Noise (%)")
